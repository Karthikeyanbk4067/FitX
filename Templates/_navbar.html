<!-- templates/_base.html (FINAL CLEANED VERSION) -->

<!DOCTYPE html>
<html lang="en">
<head>
    <style>
    .search-hidden {
        opacity: 0;
        visibility: hidden;
        width: 0;
        padding: 0;
        margin-right: 0;
        transition: all 0.2s;
        padding: 0px;
            PADDING: 0px;
    }
    .search-visible {
        opacity: 1;
        visibility: visible;
        width: 160px;
        height: 38px;
        font-size: 1rem;
        margin-right: 8px;
        padding: 6px 12px;
        transition: all 0.2s;
    }
    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}FITX{% endblock %}</title>

    <!-- UNIVERSAL STYLESHEETS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/style.css') }}">

    <!-- Link to your separate chatbot CSS file -->
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/chatbot.css') }}">

    {% block head_styles %}{% endblock %}
</head>
<body>

    <!-- PUMA-STYLE NAVBAR -->
    <header class="puma-header">
        <nav class="puma-nav">
            <div class="nav-left">
                <ul class="nav-links" style="display: flex; align-items: center; gap: 1.2rem; margin-left: 0rem; width: 149%; justify-content: space-between;padding-top:15px;">
                    <li>  <a href="{{ url_for('home') }}" class="logo" style="display: flex; align-items: center;">
                    <img src="static/assets/images/icons/Generated image 1 (3) copy.png" alt="Logo" style="height:46px;width:auto;display:block; position: relative;top: 0px; right: 50px;">
                </a></li>
                    <li><a href="{{ url_for('products_page', badge='New Arrival') }}" style="font-weight:700;color:#fff;display:flex;align-items:center;">New Arrivals</a></li>
                    <li><a href="{{ url_for('products_page', category='Men') }}" style="font-weight:700;color:#fff;">Men</a></li>
                    <li><a href="{{ url_for('products_page', category='Women') }}" style="font-weight:700;color:#fff;">Women</a></li>
                    <li><a href="{{ url_for('products_page', category='New Arrival') }}" style="font-weight:700;color:#fff;">Sports</a></li>
                </ul>
            </div>
            <div class="nav-right" style="display: flex; align-items: center; gap: 1.25rem;">
                <form class="d-flex align-items-center" action="{{ url_for('search') }}" method="get" id="navbar-search-form" style="margin:0;position:relative;">
                    <input
                        class="form-control me-2 search-hidden"
                        type="search"
                        name="q"
                        id="navbar-search-input"
                        placeholder="Search products..."
                        aria-label="Search"
                    >
                    <button
                        class="search-button"
                        type="button"
                        id="navbar-search-btn"
                        style="display: flex; align-items: center; gap: 0rem; background: #111; color: #fff; padding: 0.6rem 15px; height: 38px; font-weight: 700; cursor: pointer; width: 47px;"
                    >
                        <i class="bi bi-search"></i>
                        <span style="font-weight:700;letter-spacing:1px;"></span>
                    </button>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchBtn = document.getElementById('navbar-search-btn');
    const searchInput = document.getElementById('navbar-search-input');
    searchBtn.addEventListener('click', function() {
        if (searchInput.classList.contains('search-hidden')) {
            searchInput.classList.remove('search-hidden');
            searchInput.classList.add('search-visible');
            searchInput.focus();
        } else {
            searchInput.classList.remove('search-visible');
            searchInput.classList.add('search-hidden');
        }
    });
});
</script>
                </form>
<!-- REPLACE THIS LINE: <a href="#" class="nav-icon" title="Favourites" style="font-size:1.5rem;color:#fff;"><i class="bi bi-heart"></i></a> -->
                <a href="{{ url_for('wishlist') }}" class="nav-icon" title="Favourites" style="font-size:1.5rem;color:#fff;"><i class="bi bi-heart"></i></a>
<!-- END REPLACEMENT -->
                <a href="{{ url_for('cart_page') }}" class="nav-icon" title="Bag" style="font-size:1.5rem;color:#fff;position:relative;">
                    <i class="bi bi-cart3"></i>
                    {% if cart_item_count > 0 %}
                        <span class="cart-badge" style="position:absolute;top:2px;right:2px;font-size:0.7rem;background:#fff;color:#111;border-radius:50%;padding:1px 5px;font-weight:700;line-height:1;">{{ cart_item_count }}</span>
                    {% endif %}
                </a>
                {% if current_user.is_authenticated %}
                    <a href="{{ url_for('account_page') }}" class="nav-icon" title="My Account" style="font-size:1.5rem;color:#fff;"><i class="bi bi-person-circle"></i></a>
                {% else %}
                    <a href="{{ url_for('login_page') }}" class="nav-icon" title="Sign In" style="font-size:1.5rem;color:#fff;"><i class="bi